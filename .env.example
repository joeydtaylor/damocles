########################################
# Core service
########################################
PORT=3000
APP_NAME=authentication-microservice
BASE_URL=https://localhost:3000
FRONT_END_BASE_URL=https://localhost:3001

########################################
# Logging
########################################
LOG_DIRECTORY=log
LOG_MAX_SIZE_IN_NUMBER_MB=50

########################################
# TLS
########################################
SERVER_SSL_CERTIFICATE=etc/keys/devServerSslCertificate.crt
SERVER_SSL_PRIVATE_KEY=etc/keys/devServerSslPrivate.key

########################################
# SAML / OIDC / Local auth
########################################
SAML_IDP_BASE_URL=""
SAML_METADATA_PATH=etc/samlConfig/metadata/idpMetadata.xml
# Must match your SP ACS endpoint exactly (include port)
SAML_SP_ENTITY_ID=https://localhost:3000/api/auth/saml/consume

########################################
# OAuth2
########################################
# RSA (PKCS8/SPKI) or EC (if OAUTH_SIGNING_ALGORITHM=ES256)
OAUTH_PRIVATE_KEY_PATH=etc/keys/oauth-private.key
OAUTH_PUBLIC_KEY_PATH=etc/keys/oauth-public.key
OAUTH_SIGNING_ALGORITHM=RS256
OAUTH_ISSUER=auth-service
OAUTH_AUDIENCE=your-api
OAUTH_ACCESS_TTL_SECONDS=3600
OAUTH_ENFORCE_S256_PKCE=true
OAUTH_EXTRA_SCOPES=read:data,write:data,custom:scope
OAUTH_REFRESH_TTL_SECONDS=2592000  # 30 days

########################################
# OIDC
########################################
OIDC_ISSUER_URL=<oidc-issuer-url>
OIDC_CLIENT_ID=<oidc-client-id>
OIDC_CLIENT_SECRET=<oidc-client-secret>
OIDC_JWKS_URL=<oidc-jwks-url>
OIDC_SCOPES=openid,profile,email

########################################
# Redis
########################################
REDIS_CONNECTION_STRING=redis://redis-auth:6379

########################################
# Session cookies
########################################
SESSION_COOKIE_SECRET=megasupersecret
# Use lax for SAML top-level redirects; switch to none ONLY if you need cross-site XHR with cookies.
SESSION_COOKIE_SAME_SITE=strict
SESSION_COOKIE_NAME=s

########################################
# Roles
########################################
ADMIN_ROLE_NAME=admin
DEVELOPER_ROLE_NAME=developer
CONTRIBUTOR_ROLE_NAME=contributor
READER_ROLE_NAME=reader
AUDITOR_ROLE_NAME=auditor
SUPPORT_ROLE_NAME=support

########################################
# Postgres
########################################
POSTGRES_USER=auth_user
POSTGRES_PASSWORD=supersecret
POSTGRES_DB=auth_db
POSTGRES_HOST=postgres-auth
POSTGRES_PORT=5432
POSTGRES_URL=postgresql://auth_user:supersecret@postgres-auth:5432/auth_db

########################################
# Rate limiting (per minute unless noted)
########################################
# Authorization endpoint (GET /authorize, browser login/callback)
RL_AUTHORIZE_WINDOW_MS=60000
RL_AUTHORIZE_MAX=30

# Token endpoint – non-refresh grants (auth_code, client_credentials)
RL_TOKEN_WINDOW_MS=60000
RL_TOKEN_MAX=60

# Token endpoint – refresh_token grant (stricter)
RL_REFRESH_WINDOW_MS=60000
RL_REFRESH_MAX=10

# UserInfo endpoint
RL_USERINFO_WINDOW_MS=60000
RL_USERINFO_MAX=120

# Introspection endpoint
RL_INTROSPECT_WINDOW_MS=60000
RL_INTROSPECT_MAX=30

# Revocation endpoint
RL_REVOKE_WINDOW_MS=60000
RL_REVOKE_MAX=20

# General toggles / behavior
RL_TRUST_PROXY=true        # set app.set('trust proxy', 1) if behind proxy
RL_STANDARD_HEADERS=true   # return RateLimit-* headers
RL_LEGACY_HEADERS=false


# SIEM tee
SIEM_ENABLED=true
SIEM_HTTP_URL=https://siem.example.com/ingest
# Any single custom header for auth (or leave blank)
SIEM_HTTP_AUTH_HEADER=Authorization: Bearer YOUR_TOKEN
SIEM_BATCH_SIZE=50
SIEM_FLUSH_MS=2000
SIEM_TIMEOUT_MS=5000
SIEM_MAX_RETRIES=3

TRUST_PROXY=true                 # or a value like "loopback", "uniquelocal", "1"
ENFORCE_TLS_REDIRECT=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=false

# Optional lightweight HTTP->HTTPS redirect server
ENABLE_HTTP_REDIRECT=true
HTTP_REDIRECT_PORT=8080

# TLS tuning
TLS_MIN_VERSION=TLSv1.2          # or TLSv1.3
# TLS_CIPHERS=TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256

# Optional mTLS (internal-only!)
REQUIRE_CLIENT_CERT=false
TLS_CLIENT_CA_BUNDLE=/etc/ssl/ca-bundle.pem
