########################################
# Core service
########################################
PORT=3000
APP_NAME=authentication-microservice
BASE_URL=https://localhost:3000
FRONT_END_BASE_URL=https://localhost:3001

########################################
# Logging
########################################
LOG_DIRECTORY=log
LOG_MAX_SIZE_IN_NUMBER_MB=50

########################################
# TLS
########################################
SERVER_SSL_CERTIFICATE=etc/keys/devServerSslCertificate.crt
SERVER_SSL_PRIVATE_KEY=etc/keys/devServerSslPrivate.key
TLS_MIN_VERSION=TLSv1.2              # TLSv1.2 or TLSv1.3
#TLS_CIPHERS=TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256
REQUIRE_CLIENT_CERT=false
TLS_CLIENT_CA_BUNDLE=/etc/ssl/ca-bundle.pem

########################################
# Redis / Sessions
########################################
REDIS_CONNECTION_STRING=redis://redis-auth:6379
SESSION_COOKIE_SECRET=megasupersecret
SESSION_COOKIE_NAME=s
# lax for SAML/OIDC browser flows, strict for API-only usage, none for cross-site XHR
SESSION_COOKIE_SAME_SITE=lax

########################################
# Application Cookie (optional)
########################################
APPLICATION_COOKIE_SECRET=
APPLICATION_COOKIE_SAME_SITE=lax

########################################
# SAML (optional)
########################################
SAML_SP_ENTITY_ID=https://localhost:3000/api/auth/saml/consume
SAML_METADATA_PATH=etc/samlConfig/metadata/idpMetadata.xml

########################################
# Roles
########################################
ADMIN_ROLE_NAME=admin
DEVELOPER_ROLE_NAME=developer
CONTRIBUTOR_ROLE_NAME=contributor
READER_ROLE_NAME=reader
AUDITOR_ROLE_NAME=auditor
SUPPORT_ROLE_NAME=support

########################################
# OAuth2
########################################
OAUTH_PRIVATE_KEY_PATH=etc/keys/oauth-private.key
OAUTH_PUBLIC_KEY_PATH=etc/keys/oauth-public.key
OAUTH_SIGNING_ALGORITHM=RS256       # RS256 or ES256
OAUTH_ISSUER=auth-service
OAUTH_AUDIENCE=your-api
OAUTH_ACCESS_TTL_SECONDS=3600
OAUTH_ENFORCE_S256_PKCE=true
OAUTH_ALLOW_HEADER_USER=false
OAUTH_JWKS_CACHE_SECONDS=3600
OAUTH_REFRESH_TTL_SECONDS=2592000   # 30 days
OAUTH_EXTRA_SCOPES=read:data,write:data,custom:scope

########################################
# OIDC
########################################
OIDC_ISSUER_URL=https://dev-xxxx.okta.com/oauth2/default
OIDC_CLIENT_ID=your-client-id
OIDC_CLIENT_SECRET=your-client-secret
OIDC_JWKS_URL=https://dev-xxxx.okta.com/oauth2/default/v1/keys
OIDC_SCOPES=openid,profile,email

########################################
# Postgres
########################################
POSTGRES_USER=auth_user
POSTGRES_PASSWORD=supersecret
POSTGRES_DB=auth_db
POSTGRES_HOST=postgres-auth
POSTGRES_PORT=5432
POSTGRES_URL=postgresql://auth_user:supersecret@postgres-auth:5432/auth_db

########################################
# Rate limiting
########################################
RL_AUTHORIZE_WINDOW_MS=60000
RL_AUTHORIZE_MAX=30

RL_TOKEN_WINDOW_MS=60000
RL_TOKEN_MAX=60

RL_REFRESH_WINDOW_MS=60000
RL_REFRESH_MAX=10

RL_USERINFO_WINDOW_MS=60000
RL_USERINFO_MAX=120

RL_INTROSPECT_WINDOW_MS=60000
RL_INTROSPECT_MAX=30

RL_REVOKE_WINDOW_MS=60000
RL_REVOKE_MAX=20

RL_TRUST_PROXY=true
RL_STANDARD_HEADERS=true
RL_LEGACY_HEADERS=false

########################################
# SIEM tee
########################################
SIEM_ENABLED=false
SIEM_HTTP_URL=
SIEM_HTTP_AUTH_HEADER=
SIEM_BATCH_SIZE=50
SIEM_FLUSH_MS=2000
SIEM_TIMEOUT_MS=5000
SIEM_MAX_RETRIES=3

########################################
# HTTP/TLS Security
########################################
TRUST_PROXY=true
ENFORCE_TLS_REDIRECT=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=false

ENABLE_HTTP_REDIRECT=false
HTTP_REDIRECT_PORT=8080
